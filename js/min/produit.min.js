let productSelect, imgParent, imgProduct, productName, productLenses, productDescription, productPrice, productCardParent = document.getElementById("custom-and-select"); const getProducts = async function () { let e = await fetch("http://localhost:3000/api/cameras/"); if (e.ok) { let r = await e.json(); for (let e = 0; e < r.length; e++) { function t() { const t = new function (e, t, r, c, n, i) { this.id = e, this.imageUrl = t, this.name = r, this.lenses = c, this.price = n, this.description = i }(r[e]._id, r[e].imageUrl, r[e].name, r[e].lenses, r[e].price, r[e].description); let c = "?" + t.id; if (window.location.search.indexOf(c) > -1) { createContent(), imgProduct.setAttribute("src", t.imageUrl), productName.innerHTML = t.name, productLenses.innerHTML = t.lenses.join(" ou "), productDescription.innerHTML = t.description, productPrice.innerHTML = t.price + " €"; let e = document.querySelector("form"); productSelect.appendChild(e), document.querySelector("option").setAttribute("class", "hide"); for (let r = 0; r < t.lenses.length; r++) { let c = document.createElement("option"); document.querySelector("select").appendChild(c), c.setAttribute("class", "lense"), c.setAttribute("value", t.lenses[r]), c.setAttribute("selected", "false"), c.innerHTML = t.lenses[r], e.addEventListener("submit", function (e) { if (!0 === c.selected) { let e = JSON.parse(sessionStorage.getItem("productSelected") || "[]"); if (e.length < 5) { let r = { id: t.id, name: t.name, price: t.price, lenses: c.value }; e.push(r), sessionStorage.setItem("productSelected", JSON.stringify(e)) } else alert("Vous devez vider votre panier avant de commander un nouveau produit.") } }) } } } t() } } else console.error("Retour du serveur :", e.status) }; function createContent() { productSelect = document.createElement("div"), productCardParent.appendChild(productSelect), productSelect.setAttribute("class", "product-select"), imgParent = document.createElement("div"), productSelect.appendChild(imgParent), imgParent.setAttribute("class", "imgParent"), imgProduct = document.createElement("img"), imgParent.appendChild(imgProduct), imgProduct.classList.add("img-customize"), imgProduct.setAttribute("alt", "Personnalier votre caméra pour valider votre commande chez Oricono."), productName = document.createElement("p"), productSelect.appendChild(productName), productName.setAttribute("class", "name"), productLenses = document.createElement("p"), productSelect.appendChild(productLenses), productLenses.setAttribute("class", "lenses"), productDescription = document.createElement("p"), productSelect.appendChild(productDescription), productDescription.setAttribute("class", "description"), productPrice = document.createElement("p"), productSelect.appendChild(productPrice), productPrice.setAttribute("class", "price") } getProducts();